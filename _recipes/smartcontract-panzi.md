---
title: "区块链论文解读———以太坊中的庞氏骗局"
image: 
  path: /images/recipes/image1.png
  thumbnail: /images/recipes/image1.png
  caption: "以太坊中的庞氏骗局"
categories:
  - Smart Contract
  - Edge Case
tags:
  - content
  - css
  - edge case
  - lists
  - markup
---

本文是中山大学发表于 WWW 2018 的工作，文章提出了一种在智能合约创建时检测庞氏骗局的模型。


文正解决了智能合约领域的全新问题，完成了前所未有的工作。文章从智能合约的可公开访问的操作代码中提取代码功能，可以在造成任何损害之前检测智能智能合约中的庞氏骗局并建立基于它的风险预警平台。

* 关于编辑作者：苏莉娅，中国科学院信工所博士，研究方向为网络空间安全与大数据。
* 论文原文: Detecting Ponzi Schemes on Ethereum: Towards Healthier Blockchain Technology
* 论文下载链接:  [paper-download](https://dl.acm.org/citation.cfm?id=3186046)
* 论文作者  Weili Chen / Zibin Zheng / Jiahui Cui



## 引言

以太坊是一个基于开源区块链的分布式平台。以太坊的对应的货币称为以太币，以太坊提供图灵完备的虚拟机来执行智能代码。智能合约是相互不信任的参与者之间的计算机协议，当满足预设条件时，会自动强制执行区块链。智能合约的执行无法终止，也不依赖于受信任的权威机构。智能合约可以应用于各个领域。支持智能合约的区块链平台被认为是第二代区块链。
如今，许多庞氏骗局在智能合约的面纱下伪装自己。我们将这些庞氏骗局称为智能合约下的庞氏骗局。参与者对持续偿还的信心是庞氏骗局成功运作的关键因素，加上因为智能合约的自动执行性质似乎是庞氏骗局的一个有吸引力的工具止。更重要的是，发起人可以实现匿名。图1举例了典型智能庞氏骗局的宣传图。宣传词如下：

"你好！我的名字是Rubixi！我是以太坊区块链中新的已验证的金字塔智能合约。当你发给我一个以太时，我会在余额足够时将金额翻倍发回你的地址。我的乘数系数是动态的（最小x1.2最大x3），因此我的支出在未来几个月加速并保证"

![image-center]({{ '/images/recipes/image1.png' | absolute_url }}){: .align-center}

检测基于区块链的庞氏骗局不是一个容易的问题，因为区块链的用户基本上是匿名的。鉴于智能合约由代码组成，可以通过查看源代码来手动检查智能合约是否是庞氏骗局。但是，更糟糕的是，智能合约的源代码可能会被隐藏。事实上，只需要字节码就可以在以太坊区块链上实施智能合约。现在有超过一百万个智能合约在以太坊上运行，但只有不到四千个拥有源代码。这意味着不仅隐藏了创造者，而且还隐藏了潜在的智能庞氏骗局的逻辑。这提出了许多问题：以太坊上有多少智能庞氏骗局？有哪些类型的智能庞氏骗局？它们的特点是什么？智能庞氏骗局的影响力是多少？在回答这些问题之前，要回答的第一个也是最重要的问题是：如何在没有源代码的情况下检测智能庞氏骗局？为了建立一个有效的模型来检测没有源代码的智能庞氏方案，我们提出了我们的模型。

本文的创新点与贡献主要有：
本文的一个重要贡献是实验验证了检测智能庞氏骗局的可行性。通过使用该模型，可以：
1. 检测智能庞氏方案，即使源代码是故意隐藏的; 
2. 在造成任何损害之前检测智能庞氏骗局; 
3. 建立基于它的风险预警平台。



## 模型

数据情况：
为了建立一个有效的模型来检测智能庞氏骗局，从网站http://etherscan.io收集了1382份经过验证的智能合约。检查智能合约并将它们整理为我们模型的ground truth。具体，收集了131个庞氏骗局智能合约和1251个非庞氏骗局智能合约。
特征情况：
从数据中提取了交易和代码两类特征。

![image-center]({{ '/images/recipes/image2.png' | absolute_url }}){: .align-center}

![image-center]({{ '/images/recipes/image3.png' | absolute_url }}){: .align-center}

交易特征：
通过检查Rubixi的以太流量图，可以发现庞氏智能合约中的三个行为特征：1）支付行为通常发生在收益交易之后，表明合约经常支付给已知账户; 2）许多收益交易不跟随支付交易; 3）一些参与者收益交易比支付交易多很多。
下面列举具体使用的特征：
* Known rate (Kr): 在此次智能合约付款前投资的接收者的比例。高Kr意味着与已经知道的账户进行更多互动。智能庞氏骗局具有非常高的Kr。
* Balance (Bal): 智能合约的balance。
* N_investment (N_Inv) : 投资者数量。
* N_payment (N_pay) : 支付数量
* Difference index (D_ind) : 该指数用于衡量合同中所有参与者的支付与收益之间的差异，具体可参考论文。
* Paid rate (Pr): 至少收到过一次收益的用户比例
* N_maxpay (N_max): 支付合约中最多支付给已知账号的个量

代码特征：
提取所有二进制代码并计算频率。在1382个合约执行代码中发现了64个不同的二进制代码。

![image-center]({{ '/images/recipes/image4.png' | absolute_url }}){: .align-center}

模型说明：
从交易中提取帐户和代码特征，再基于XGBoost的构建分类模型。

## 实验

表2总结了不同特征情况下检测智能庞氏骗局有效性。

![image-center]({{ '/images/recipes/image5.png' | absolute_url }}){: .align-center}

从图中可以清楚地看出，最重要的特征是GASLIMIT，它用于获得块的气体限制。这个结果与普通意义相反，因为对于智能庞氏骗局来说，获得区块的天然气限制是完全没有必要的。为了找到真正的原因，我们选择了Ponzi方案合同的一些源代码，这些合同在其操作代码中具有GASLIMIT。我们发现这些合同导入了oracle API，导致了操作码。
为了估计以太坊上的智能庞氏方案的数量，之前的研究通过使用两个字节码文件之间的相似性来检测隐藏的智能庞氏方案（没有源代码的庞氏方案契约）。文中发现了54个隐藏的智能庞氏骗局。为了验证模型的可靠性，我们根据代码特征预测了模型的54个隐藏契约。结果显示，54个（83％）合同中有45个是智能庞氏骗局。其余通过人工检测发现并不是真正的庞氏骗局。这些发现表明，与字节码相似性相比，我们的模型在检测智能庞氏方案时更加准确。

![image-center]({{ '/images/recipes/image6.png' | absolute_url }}){: .align-center}

为了估算以太坊上有多少聪明的庞氏骗局，我们首先下载了2017年5月7日之前创建的所有合约，我们总共获得了280704份合约。然后我们提取了这些智能合约的所有操作码功能，并使用我们的模型进行预测。模型发现了386个聪明的庞氏骗局（包括经过验证的）。因此，据估计，2017年5月7日之前，在以太坊平台上运行的智能庞氏骗局将近434个（386倍精确/召回），占所有合约的0.15％。图7示出了具有相应分数（概率）的检测到的智能庞氏骗局的计数。从图中可以清楚地看出，更多检测到的智能庞氏骗局得分相对较高，表明庞氏骗局的问题比估计的更严重。事实上，在最近的研究[3]中只报告了191个聪明的庞氏骗局，这远远低于此处估计的数量。

## 总结

基于区块链和加密货币的金融诈骗已经成为一个重要的研究问题。随着区块链技术的发展，庞氏骗局隐藏在智能合约的面纱之下。在这项研究中，我们提出了一种检测智能庞氏骗局的方法。使用手动检查的样本和XGBoost，构建基于提取帐户和代码特征的回归树模型。实验结果表明，该模型具有较高的精度，可用于实际检测潜在的智能庞氏方案。最重要的结果是，使用我们提取的任何运行合同中可公开访问的代码功能，足以构建一个实用的模型来检测庞氏方案合同的创建时刻。此外，我们估计在以太坊上有超过400个智能庞氏骗局，远远超过之前的估计。

在未来，我们将在三个方面进一步研究这项研究。首先，扩展真相的数据集，改进分类模型。随着具有源代码的智能合约的数量每天都在增加，可以通过手动检查源代码来扩展真相数据集。通过更多的真相的数据集，可以开发出更准确，更可靠的模型。其次，建立一个统一的平台，为每一个可能的骗局智能合约评分。我们正在尝试建立一个网站，重点是通过数据挖掘方法检测智能合约。第三，研究其他类型的骗局。除了智能庞氏骗局，许多其他骗局正在利用区块链技术。有必要研究这个问题，以促进区块链技术的发展。